
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation and user guides for Amesto Fortytwo">
      
      
      
      
        <link rel="prev" href="../github-managedapp/">
      
      
        <link rel="next" href="../github/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.3.1">
    
    
      
        <title>Configuring GitHub self hosted runners using VMSS - Documentation for Amesto Fortytwo</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.046329b4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#configuring-github-self-hosted-runners-using-vmss" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Documentation for Amesto Fortytwo" class="md-header__button md-logo" aria-label="Documentation for Amesto Fortytwo" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Documentation for Amesto Fortytwo
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Configuring GitHub self hosted runners using VMSS
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/amestofortytwo/public-docs.byfortytwo.com" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Documentation for Amesto Fortytwo" class="md-nav__button md-logo" aria-label="Documentation for Amesto Fortytwo" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Documentation for Amesto Fortytwo
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/amestofortytwo/public-docs.byfortytwo.com" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Managed Azure AD B2C
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Managed Azure AD B2C
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Managed%20Azure%20AD%20B2C/test2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to MkDocs 2
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Security Posture Portal
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Security Posture Portal
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Security%20Posture%20Portal/howtocancel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to cancel subscription of the Security Posture Portal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Security%20Posture%20Portal/howtosetup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to setup/onboard the portal from Azure marketplace
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Security%20Posture%20Portal/main/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to Amesto Fortytwo Security Posture portal for Microsoft 365
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Self Hosted Runners
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Self Hosted Runners
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../azuredevops-managedapp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Azure DevOps self hosted runners -
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../azuredevops-vmss/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuring Azure DevOps self hosted runners using VMSS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../github-managedapp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GitHub self hosted runners - Managed application
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Configuring GitHub self hosted runners using VMSS
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Configuring GitHub self hosted runners using VMSS
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#step-1-configuring-the-virtual-machine-scale-set" class="md-nav__link">
    Step 1 - Configuring the Virtual Machine Scale Set
  </a>
  
    <nav class="md-nav" aria-label="Step 1 - Configuring the Virtual Machine Scale Set">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basics" class="md-nav__link">
    Basics
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spot" class="md-nav__link">
    Spot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disks" class="md-nav__link">
    Disks
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#networking" class="md-nav__link">
    Networking
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scaling" class="md-nav__link">
    Scaling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#management-health-advanced-and-tags" class="md-nav__link">
    Management, Health, Advanced and Tags
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#final-configuration" class="md-nav__link">
    Final configuration
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-configuring-the-vmss-instances-to-automatically-register-to-github" class="md-nav__link">
    Step 2 - Configuring the VMSS instances to automatically register to GitHub
  </a>
  
    <nav class="md-nav" aria-label="Step 2 - Configuring the VMSS instances to automatically register to GitHub">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ubuntu" class="md-nav__link">
    Ubuntu
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#windows" class="md-nav__link">
    Windows
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-example-of-using-the-self-hosted-runners" class="md-nav__link">
    Step 3 - Example of using the self hosted runners
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../github/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuring GitHub self hosted runners
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#step-1-configuring-the-virtual-machine-scale-set" class="md-nav__link">
    Step 1 - Configuring the Virtual Machine Scale Set
  </a>
  
    <nav class="md-nav" aria-label="Step 1 - Configuring the Virtual Machine Scale Set">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basics" class="md-nav__link">
    Basics
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spot" class="md-nav__link">
    Spot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disks" class="md-nav__link">
    Disks
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#networking" class="md-nav__link">
    Networking
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scaling" class="md-nav__link">
    Scaling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#management-health-advanced-and-tags" class="md-nav__link">
    Management, Health, Advanced and Tags
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#final-configuration" class="md-nav__link">
    Final configuration
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-configuring-the-vmss-instances-to-automatically-register-to-github" class="md-nav__link">
    Step 2 - Configuring the VMSS instances to automatically register to GitHub
  </a>
  
    <nav class="md-nav" aria-label="Step 2 - Configuring the VMSS instances to automatically register to GitHub">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ubuntu" class="md-nav__link">
    Ubuntu
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#windows" class="md-nav__link">
    Windows
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-example-of-using-the-self-hosted-runners" class="md-nav__link">
    Step 3 - Example of using the self hosted runners
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="configuring-github-self-hosted-runners-using-vmss">Configuring GitHub self hosted runners using VMSS</h1>
<p><strong>Note:</strong> This guide is unfinished</p>
<p>This documentation shows you how to configure an Azure Virtual Machine Scale Set (VMSS) with the latest Self Hosted Runner image, and configuring the VMSS instances to automatically register as self hosted runners in GitHub. Using a VMSS gives you the ability easily increase and decrease the number of active runners whenever you want, manually for now, but it is possible to automate. Additionally, the VMSS will always create instances based on the latest runner image published to the Azure Marketplace, so you will never need to worry about updating the operating system and toolkit - just like the hosted runners!</p>
<p>To configure, you need to follow the three steps below:</p>
<ol>
<li>Configuring the Virtual Machine Scale Set</li>
<li>Configuring the VMSS instances to automatically register to GitHub</li>
<li>Testing the self hosted runner (Not really required)</li>
</ol>
<h2 id="step-1-configuring-the-virtual-machine-scale-set">Step 1 - Configuring the Virtual Machine Scale Set</h2>
<p><strong>Note:</strong> If you do not want to handle the creation of the VMSS manually, you can use our <a href="../github-managedapp/">Azure Managed Application</a> instead.</p>
<p>Start by going to the Azure Portal and click <strong>+Create a resource</strong>. </p>
<p><img alt="" src="../media/20230914091454.png" /></p>
<p>Search for <strong>Virtual Machine Scale Set</strong>, click on the result and click <strong>Create</strong></p>
<p><img alt="" src="../media/20230914091624.png" /></p>
<h3 id="basics">Basics</h3>
<ul>
<li><strong>Project details</strong><ul>
<li><strong>Subscription</strong> - A subscription you have contributor access to<ul>
<li><strong>Resource group</strong> - A new or existing resource group</li>
</ul>
</li>
</ul>
</li>
<li><strong>Scale set details</strong><ul>
<li><strong>Virtual machine scale set name</strong> - The name of the scale set itself. Cannot be changed after deployment, but everything is stateless, so you can simply deploy a new scale set if needed.</li>
<li><strong>Region</strong> - The region where you want your runners to be located</li>
<li><strong>Availability zone</strong> - Configure to None in order to allow for a cluster with few running instances</li>
</ul>
</li>
<li><strong>Orchestration</strong><ul>
<li><strong>Orchestration mode</strong> - Configure to <strong>Uniform</strong>, as we will be running only a single image and runner type</li>
<li><strong>Security type</strong> - Standard is the only supported for our image currently</li>
</ul>
</li>
<li>
<p><strong>Instance details</strong></p>
<ul>
<li><strong>Image</strong> - Locate the Amesto Fortytwo <strong>Self Hosted Runner for GitHub</strong> image and select whether you want an Ubuntu or Windows based runner:</li>
</ul>
<p><img alt="" src="../media/20230914092637.png" /></p>
<ul>
<li><strong>Run with Azure Spot discount</strong> - Only select this if you know how to handle spot, and if your pipelines can tolerate evictions</li>
<li><strong>Size</strong> - Choose the virtual machine size you want to run the runners as</li>
<li><strong>Administrator account</strong></li>
<li>Configure an administrator account for you virtual machines</li>
</ul>
</li>
</ul>
<p><img alt="" src="../media/20230914091817.png" />
<img alt="" src="../media/20230914092429.png" /></p>
<h3 id="spot">Spot</h3>
<p>Skip configuring <strong>Spot</strong> unless you chose to <strong>Run with Azure spot discount</strong>.</p>
<h3 id="disks">Disks</h3>
<p>Leave <strong>Disks</strong> as default and go to the next page.</p>
<h3 id="networking">Networking</h3>
<p>On the <strong>Networking</strong> page, you can choose between creating a new network or reuse an existing one. You can easily connect to a virtual network that is peered into a Azure Landing Zones solution and use private endpoints and stuff. Please be aware that the runners require internet connectivity in order to reach GitHub.</p>
<ul>
<li><strong>Load balancing options</strong> - Choose <strong>None</strong>, as GitHub takes care of this</li>
</ul>
<p>The default settings will work just fine in most cases:</p>
<p><img alt="" src="../media/20230914093403.png" /></p>
<h3 id="scaling">Scaling</h3>
<p>For scaling, GitHub will take care of everything. However, you should configure <strong>Initial instance count</strong> to <strong>0</strong>, as we need to configure the VMSS for GitHub connectivity before creating our instances.</p>
<p><img alt="" src="../media/20230914093755.png" /></p>
<h3 id="management-health-advanced-and-tags">Management, Health, Advanced and Tags</h3>
<p>No need to configure any of this. Just click next and complete the deployment of VMSS.</p>
<p><img alt="" src="../media/20230914093939.png" /></p>
<h3 id="final-configuration">Final configuration</h3>
<p>After successfully creating the VMSS instance, click <strong>Go to resource</strong></p>
<p><img alt="" src="../media/20230914094919.png" /></p>
<p>Under <strong>Upgrade policy</strong>, switch from manual to <strong>Automatic</strong>.</p>
<p><img alt="" src="../media/20230914095007.png" /></p>
<h2 id="step-2-configuring-the-vmss-instances-to-automatically-register-to-github">Step 2 - Configuring the VMSS instances to automatically register to GitHub</h2>
<p>Unfinished example - TODO by Marius og Ketil:</p>
<h3 id="ubuntu">Ubuntu</h3>
<pre><code class="language-bash"># Install
mkdir actions-runner &amp;&amp; cd actions-runner
curl -o actions-runner-linux-x64.tar.gz -L https://github.com/actions/runner/releases/download/v2.309.0/actions-runner-linux-x64-2.309.0.tar.gz
echo &quot;2974243bab2a282349ac833475d241d5273605d3628f0685bd07fb5530f9bb1a  actions-runner-linux-x64.tar.gz&quot; | shasum -a 256 -c
tar xzf ./actions-runner-linux-x64.tar.gz


./config.sh --url https://github.com/XXX --token XXX --unattended
sudo ./svc.sh install
sudo ./svc.sh start
</code></pre>
<h3 id="windows">Windows</h3>
<h2 id="step-3-example-of-using-the-self-hosted-runners">Step 3 - Example of using the self hosted runners</h2>
<p>The following is an example action using the pool we just created. It should be created with a name of <code>.github/workflows/test.yml</code>. Note the runs-on configured as self-hosted, which can be configured to require additional things, such as "Linux" and so on.</p>
<pre><code class="language-yaml">name: GitHub Actions Example
run-name: ${{ github.actor }} is testing out GitHub Actions üöÄ
on: [push]
jobs:
  Explore-GitHub-Actions:
    runs-on: self-hosted
    steps:
      - run: echo &quot;üêß This job is now running on a ${{ runner.os }} server&quot;
</code></pre>
<p>After a commit, we should see this action running just fine:</p>
<p><img alt="" src="../media/20230914154822.png" /></p>
<p>That's it, you now have self hosted runners for GitHub up and running, that will automatically be updated whenever the hosted runners are updated (through our image). Have fun!</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Made on the run üèÉ
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.dff1b7c8.min.js"></script>
      
    
  </body>
</html>